<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · CoupledSystems.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">CoupledSystems.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../guide/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Theory</a><ul class="internal"><li><a class="tocitem" href="#The-Relationship-between-Explicit-and-Implicit-Components"><span>The Relationship between Explicit and Implicit Components</span></a></li><li><a class="tocitem" href="#Derivatives-of-Explicit-and-Implicit-Components"><span>Derivatives of Explicit and Implicit Components</span></a></li><li><a class="tocitem" href="#Explicit-Systems"><span>Explicit Systems</span></a></li><li><a class="tocitem" href="#Implicit-Systems"><span>Implicit Systems</span></a></li><li><a class="tocitem" href="#Analytical-Sensitivity-Equations"><span>Analytical Sensitivity Equations</span></a></li><li><a class="tocitem" href="#Reducing-Systems-of-Components-to-a-Single-Explicit-Component"><span>Reducing Systems of Components to a Single Explicit Component</span></a></li></ul></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/CoupledSystems.jl/blob/master/docs/src/theory.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h1><p>CoupledSystems is developed around the idea that most functions and/or system components may be modeled as either an explicit vector valued function <span>$y = f(x)$</span> or an implicit vector-valued residual function <span>$0 = r(x, y)$</span>, where <span>$x$</span> is a vector which contains the inputs to a system component and <span>$y$</span> is a vector which contains the outputs from a system component.  For implicit components, valid outputs correspond to those which satisfy the vector valued residual function <span>$0 = r(x,y)$</span> for a given set of inputs <span>$x$</span>.</p><h2 id="The-Relationship-between-Explicit-and-Implicit-Components"><a class="docs-heading-anchor" href="#The-Relationship-between-Explicit-and-Implicit-Components">The Relationship between Explicit and Implicit Components</a><a id="The-Relationship-between-Explicit-and-Implicit-Components-1"></a><a class="docs-heading-anchor-permalink" href="#The-Relationship-between-Explicit-and-Implicit-Components" title="Permalink"></a></h2><p>Explicit components may easily be converted to implicit components by subtracting the provided outputs <span>$bar{y}$</span> from the actual outputs <span>$y = f(x)$</span>, resulting in the following residual equation</p><p class="math-container">\[0 = r(x, \bar{y}) = f(x) - \bar{y}\]</p><p>Implicit components, on the other hand, may be effectively &quot;seen&quot; as explicit components once they are coupled with a solver which converges their residual equations to zero.  For example, while a computational fluid dynamics program internally solves an implicit system of equations to obtain fluid properties throughout a domain, programs which call the same CFD package effectively see the CFD package as an explicit component from which they expect to receive a converged set of outputs <span>$y$</span> given a set of inputs <span>$x$</span>.</p><p>There is an important caveat in the effective conversion from implicit to explicit components.  While explicit components inherently contain a one-to-one mapping between inputs and outputs, the same is not true for implicit components.  Multiple sets of outputs may be able to satisfy the residual equations of an implicit component for a given set of inputs.  If a one-to-one mapping does not exist for a given implicit component, then the outputs from that component are dependent on the choice of solver and initial output guess, in addition to the inputs (if a solution exists at all!).</p><p><img src="../explicit-implicit.svg" alt/></p><h2 id="Derivatives-of-Explicit-and-Implicit-Components"><a class="docs-heading-anchor" href="#Derivatives-of-Explicit-and-Implicit-Components">Derivatives of Explicit and Implicit Components</a><a id="Derivatives-of-Explicit-and-Implicit-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Derivatives-of-Explicit-and-Implicit-Components" title="Permalink"></a></h2><p>It is often useful to obtain the sensitivities of the outputs of a given system to its inputs.  This helps to both understand the system and inform gradient-based optimization.</p><p>The sensitivities of the outputs to the inputs for an explicit component is simply the partial derivative of the output function with respect to the inputs.</p><p class="math-container">\[\frac{dy}{dx} = \frac{\partial f}{\partial x}\]</p><p>The partial derivatives <span>$\frac{\partial f}{\partial x}$</span> may be computed analytically, with automatic differentiation, and/or with finite differencing.</p><p>To obtain the sensitivities of the outputs with respect to the inputs for an implicit component we first take the total derivative of the residual function with respect to the inputs.</p><p class="math-container">\[\frac{dr}{dx} = \frac{\partial r}{\partial x} + \frac{\partial r}{\partial y}\frac{dy}{dx}\]</p><p>The total derivative <span>$frac{dr}{dx}$</span> in this expression is zero since any change in the inputs for a valid set of outputs will still result in a zero-valued residual function.</p><p class="math-container">\[0 = \frac{\partial r}{\partial x} + \frac{\partial r}{\partial y}\frac{dy}{dx}\]</p><p>We now manipulate this expression to obtain the derivative of the outputs with respect to the inputs.</p><p class="math-container">\[\frac{dy}{dx} = -\left(\frac{\partial r}{\partial y}\right)^{-1}\frac{\partial r}{\partial x}\]</p><p>The partial derivatives <span>$\frac{\partial r}{\partial x}$</span> and <span>$\frac{\partial r}{\partial y}$</span> may be computed analytically, with automatic differentiation, and/or with finite differencing.  Note that the converged set of outputs <span>$y$</span> must be used when calculating the partials to obtain a valid set of derivatives.</p><h2 id="Explicit-Systems"><a class="docs-heading-anchor" href="#Explicit-Systems">Explicit Systems</a><a id="Explicit-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Systems" title="Permalink"></a></h2><p>We define an explicit system as a system containing explicit components where each component&#39;s inputs correspond to either one of the previously evaluated component&#39;s outputs or the system inputs.  An illustration of an explicit system is shown in the following diagram.</p><p><img src="../explicit-system.svg" alt/></p><p>An explicit system maps a set of inputs to a set of outputs through an explicit input-output relationship.  It may therefore be seen as a single explicit component composed of multiple explicit components.</p><p><img src="../explicit-system-component.svg" alt/></p><p>Since there are no implicit dependencies in an explicit system, the chain rule may be used in forward or reverse mode to calculate the derivatives of the outputs with respect to the inputs.  </p><p>The computational cost of applying the chain rule scales linearly with either the inputs or outputs depending on whether the chain rule is applied in forward or reverse mode respectively.  It is therefore advised to apply the chain rule in forward mode if the number of outputs exceeds the number of inputs and reverse mode otherwise.</p><h2 id="Implicit-Systems"><a class="docs-heading-anchor" href="#Implicit-Systems">Implicit Systems</a><a id="Implicit-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Systems" title="Permalink"></a></h2><p>We define an implicit system as a system containing implicit components where the system&#39;s residuals and outputs correspond to each of its subcomponent&#39;s residuals and outputs concatenated.  The inputs to each subcomponent may correspond to the system inputs and/or the outputs of any other subcomponent.  An illustration of an implicit system is shown in the following diagram.</p><p><img src="../implicit-system.svg" alt/></p><p>Since explicit components may be easily converted to implicit components, implicit systems may be used to model any combination of explicit and implicit components.  Implicit systems may be viewed as a single implicit component with a set of residual equations and outputs corresponding to those of its subcomponents.</p><p><img src="../implicit-system-component.svg" alt/></p><p>The partial derivatives of an implicit system with respect to its inputs and outputs may be constructed using the partial derivatives of its subcomponents with respect to their inputs and outputs.  In many cases, the resulting matrix will be sparse.</p><h2 id="Analytical-Sensitivity-Equations"><a class="docs-heading-anchor" href="#Analytical-Sensitivity-Equations">Analytical Sensitivity Equations</a><a id="Analytical-Sensitivity-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-Sensitivity-Equations" title="Permalink"></a></h2><p>As we have defined them, the outputs of implicit components (including implicit systems) are identical to the state variables of the system.  In many cases, however, implicit components are coupled with output equations which calculate a relatively small number of important outputs from the inputs and state variables of an implicit component.  In this case, we can apply the analytic sensitivity equations to drastically reduce the computational cost of computing the derivatives of the implicit component.  </p><p>The cost of applying the analytic sensitivity equations scales linearly with the number of inputs or outputs in direct or adjoint mode respectively. It is therefore advised to use the direct mode of the analytic sensitivity equations when the number of outputs exceeds the number of inputs and adjoint mode otherwise.</p><h2 id="Reducing-Systems-of-Components-to-a-Single-Explicit-Component"><a class="docs-heading-anchor" href="#Reducing-Systems-of-Components-to-a-Single-Explicit-Component">Reducing Systems of Components to a Single Explicit Component</a><a id="Reducing-Systems-of-Components-to-a-Single-Explicit-Component-1"></a><a class="docs-heading-anchor-permalink" href="#Reducing-Systems-of-Components-to-a-Single-Explicit-Component" title="Permalink"></a></h2><p>Any system composed of explicit and implicit components may be reduced to a single explicit component.  For example, all components may be converted into implicit components, combined into a single implicit system, and then converted to an explicit component.  Alternatively, interdependent components may be combined together into implicit systems which may then be converted into explicit components and then combined with other explicit components into an explicit system.  While the result of the different approaches is the same, the computational efficiency may vary.  For example, the latter approach for combining components together is likely more computationally efficient than the former approach.   In any case, once the system has been reduced into a single explicit component using CoupledSystems, that component may be used to easily obtain outputs and derivatives of the outputs given a set of inputs.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../guide/">« Getting Started</a><a class="docs-footer-nextpage" href="../library/">Library »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 1 April 2021 16:05">Thursday 1 April 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
